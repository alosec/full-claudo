#!/bin/bash

# Full Claudo - Simple Multi-Agent Claude System
# Usage: claudo up|down|logs|plan|worker|critic|oracle|--version|-v

# Detect if we're running in container or on host
# Check if we're in a Docker container environment
if [[ -f "/.dockerenv" ]]; then
  CLAUDO_LIB="/workspace"
else
  # Running on host - use local dist directory
  SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
  CLAUDO_LIB="$SCRIPT_DIR"
fi

# Handle version flag
if [[ "$1" == "--version" || "$1" == "-v" ]]; then
  # Extract version from package.json
  if [[ -f "$CLAUDO_LIB/package.json" ]]; then
    VERSION=$(node -p "require('$CLAUDO_LIB/package.json').version")
  elif [[ -f "package.json" ]]; then
    VERSION=$(node -p "require('./package.json').version")  
  else
    VERSION="unknown"
  fi
  echo "claudo version $VERSION"
  exit 0
fi

# Pass all commands through cli.js for unified argument handling
node "$CLAUDO_LIB/dist/src/cli.js" "$@"